.TH edge 8  "5 Jan 2024" "version 3" "SUPERUSER COMMANDS"
.SH NAME
edge \- n3n edge node daemon
.SH SYNOPSIS
.B edge
start [options..] [command] [command args]
.br
    [\-c <community>] [\-l <supernode host:port>] [further options]...
.SH DESCRIPTION
N3N is a peer-to-peer VPN system. Edge is the edge node daemon for n3n which
creates a TAP interface to expose the n3n virtual LAN. On startup n3n creates
the TAP interface and configures it then registers with the supernode so it can
begin to find other nodes in the community.
.PP
The name of the config file is constructed from the sessionname.  The default
session name is "edge", which results in looking for a config file called "edge.conf"
in the "/etc/n3n" directory.  Any command line arguments will override those
loaded from the config file.
.PP
The config file is similar to an INI file, with multiple sections and one
option per line.
Lines starting with a "#" are ignored.
An equal sign ('=') should be used between option and value.
.SH OPTIONS FOR THE UNDERLYING NETWORK CONNECTION
Some of the most common options also have a shortcut version, you can see all
these with:
.PP
.B edge help options
.PP
.TP
\fB\-O \fR<\fIsection\fR>.<\fIoption\fR>=<\fIvalue\fR>
Sets any config option value.
.TP
\fB\-c \fR<\fIcommunity\fR>, \fB\-\-community\fR=<\fIcommunity\fR>
sets the n3n community name (see also N2N_COMMUNITY in ENVIRONMENT). All edges
within the same community appear on the same LAN (layer 2 network segment).
Community name is 16 bytes in length. A name smaller than this is padded with
0x00 bytes and a name longer than this is truncated to take the first 16 bytes.
.TP
\fB\-l \fR<\fIhost:port\fR>, \fB\-\-supernode-list\fR=<\fIhost:port\fR>
sets the n3n supernode IP address and port to register to. Multiple supernodes
can be specified.
.TP
\fB\-k \fR<\fIkey\fR>
encryption key (ASCII) - also N2N_KEY=<key>
\-k <keystring>
sets the encryption key from ASCII text (see also N2N_KEY in
ENVIRONMENT). All edges communicating must use the same key and community
name. If -k not specified then edge uses cleartext mode (no encryption).
.TP
\fB\-A \fR<\fIcipher\fR>
choose a cipher for payload encryption, requires a key,
Twofish, AES (default if key provided),
ChaCha20, Speck
.TP
\fB\-z \fR<\fIcompresion\fR>
compress outgoing data packets. One of -z lzo, -z none
or -z zstd (if supported)
.TP
.SH TAP DEVICE AND OVERLAY NETWORK CONFIGURATION
.TP
\fB\-a \fR[\fImode\fR]<\fIip\fR>[\fI/n\fR]
interface address and optional CIDR subnet, default '/24',
mode = [static|dhcp]:, for DHCP use '\-r -a dhcp:0.0.0.0',
edge draws IP address from supernode if no '\-a ...' given
.TP
\fB\-r\fR
enable IP packet forwarding/routing through the n3n virtual LAN. Without this
option, IP packets arriving over n3n are dropped if not for the -a <addr> (or
DHCP assigned) IP address of the edge interface. This option is also required
to allow n3n device being used in network bridging, e.g. with brctl.
.SH LOCAL OPTIONS
.TP
\fB\-f\fR
do not fork and run as a daemon, rather run in foreground
.TP
\fB\-v\fR, \fB\-\-verbose\fR
make more verbose, repeat as required
.TP
\fb\-h\fr
write usage then exit.
.TP
\fb\--help\fr
shows detailed parameter description
.SH CONFIG FILE
Blah
.SH ENVIRONMENT
.TP
.B N2N_KEY
set the encryption key so it is not visible at the command line
.TP
.B N2N_COMMUNITY
set the community name so it is not visible at the command line
.TP
.B N2N_PASSWORD
set the password for user-password authentication so it is not visible at the command line
.SH EXAMPLES
.TP
.B edge \-Otuntap.name=n3n0 \-c mynetwork \-k encryptme \-Odaemon.userid=99 \-Odaemon.groupid=99 \Otuntap.macaddr=DE:AD:BE:EF:01:23 \-a 192.168.254.7 \-Oconnection.bind=50001 \-l 123.121.120.119:7654

Start edge with TAP device n3n0 on community "mynetwork" with community
supernode at 123.121.120.119 UDP port 7654 and bind the locally used UDP port to
50001. Use "encryptme" as the single permanent shared encryption key. Assign MAC
address DE:AD:BE:EF:01:23 to the n3n interface and drop to user=99 and group=99
after the TAP device is successfully configured.
.PP
Add the -f option to stop edge running as a daemon.
.PP
Somewhere else setup another edge with similar parameters, eg.

.B edge \-Otuntap.name=n3n0 \-c mynetwork \-k encryptme \-Odaemon.userid=99 \-Odaemon.groupid=99 \Otuntap.macaddr=DE:AD:BE:EF:01:21 \-a 192.168.254.5 \-Oconnection.bind=50001 \-l 123.121.120.119:7654
.PP
Now you can ping from 192.168.254.5 to 192.168.254.7.
.PP
The MAC address (tuntap.macaddr) and virtual IP address (-a <addr>) must be
different on all edges in the same community.

.SH CLEARTEXT MODE
If
.B -k
is not specified then edge uses cleartext mode. In cleartext mode there is no
transform of the packet data it is simply encrypted. This is useful for
debugging n3n as packet contents can be seen clearly.

To prevent accidental exposure of data, edge only enters cleartext mode when no
keying parameters are specified. In the case where keying parameters are
specified but no valid keys can be determined, edge exits with an error at
startup. If all keys become invalid while running, edge continues to encode
using the last key that was valid.

.SH MANAGEMENT INTERFACE
Edge provides a very simple management system on UDP port 5644. See the docs/ManagementAPI.md
for details.

.SH EXIT STATUS
edge is a daemon and any exit is an error.
.SH AUTHORS
.TP
Hamish Coleman
hamish (at) zot.org - n3n maintainer
.TP
Richard Andrews
andrews (at) ntop.org - n2n-1 maintainer and main author of n2n-2
.TP
Luca Deri
deri (at) ntop.org - original author of n2n
.TP
Don Bindner
(--) - significant contributions to n2n-1
.SH SEE ALSO
ifconfig(8) supernode(1) tunctl(8) n3n(7)
.br
the documentation contained in the source code
.br
the extensive documentation found in n3n's \fBdoc/\fR folder

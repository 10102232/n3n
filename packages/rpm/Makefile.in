#
# Change it according to your setup
#
N3N_HOME=$(PWD)/../..

VERSION:=$(shell $(N3N_HOME)/scripts/version.sh |tr - _)
ARCH:=$(shell rpmbuild -E '%_arch')

RPM_PKG=n3n-$(VERSION)-1.$(ARCH).rpm

all: clean pkg

pkg:
	rpmbuild --define='VERSION ${VERSION}' --define='TOPDIR ${N3N_HOME}' -bb ./n3n.spec
	-@@RPM_SIGN_CMD@ $(HOME)/rpmbuild/RPMS/$(ARCH)/$(RPM_PKG)
	@echo ""
	@echo "Package contents:"
	@rpm -qpl $(HOME)/rpmbuild/RPMS/$(ARCH)/$(RPM_PKG)
	@echo "The package is now available in $(HOME)/rpmbuild/RPMS/$(ARCH)/$(RPM_PKG)"

distclean:
	echo "dummy distclean"

install:
	echo "dummy install"

clean:
	rm -rf *~ *rpm
